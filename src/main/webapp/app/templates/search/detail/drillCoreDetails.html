<div ng-include="'app/templates/main/partial/detailview_header.html'"></div>

<div id="elementToFocus" tabindex="1" style="outline: 0" ng-arrow-left="detailCtrl.reload({table:'drillcore', left:true})" ng-arrow-right="detailCtrl.reload({table:'drillcore', right:true})" class="panel detailview-page">
    <div class="panel-body detailview-max-width" data-ng-if="detailCtrl.results != null">

        <div class="row">
            <div class="col-sm-12">
                <div class="detailview-title">
                    <h2><localize et="detailCtrl.results.drillcore" en="detailCtrl.results.drillcore_en"/></h2>
                    <div>
                        <em>(ID: {{detailCtrl.results.id}})</em>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6" bs-loading-overlay bs-loading-overlay-reference-id="detailView" bs-loading-overlay-template-url="app/templates/main/partial/loading.overlay.html">

                <h3> {{ 'DETAILVIEW_TABLE_HEADER' | translate }} </h3>
                <table class="table table-bordered table-hover table-header-styles">

                    <tr data-ng-if="detailCtrl.results.id && detailCtrl.results.id != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.ID ' | translate }} </td>
                        <td> {{detailCtrl.results.id }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.drillcore && detailCtrl.results.drillcore != null)
                        || (detailCtrl.results.drillcore_en && detailCtrl.results.drillcore_en != null) ">
                        <td><localize-label et="'API_TRANSLATION.DRILL_CORE.DRILLCORE'" en="'API_TRANSLATION.DRILL_CORE.DRILLCORE_EN'"/></td>
                        <td><localize et="detailCtrl.results.drillcore" en="detailCtrl.results.drillcore_en"/></td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.locality__locality && detailCtrl.results.locality__locality != null)
                        || (detailCtrl.results.locality__locality_en && detailCtrl.results.locality__locality_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.DRILL_CORE.LOCALITY__LOCALITY'"
                                            en="'API_TRANSLATION.DRILL_CORE.LOCALITY__LOCALITY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'locality',id:detailCtrl.results.locality_id})">
                                <localize et="detailCtrl.results.locality__locality" en="detailCtrl.results.locality__locality_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.boxes && detailCtrl.results.boxes != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.BOXES ' | translate }} </td>
                        <td> {{ detailCtrl.results.boxes }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.box_numbers && detailCtrl.results.box_numbers != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.BOX_NUMBERS ' | translate }} </td>
                        <td> {{ detailCtrl.results.box_numbers }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.depository__value && detailCtrl.results.depository__value != null)
                        || (detailCtrl.results.depository__value_en && detailCtrl.results.depository__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.DRILL_CORE.DEPOSITORY__VALUE'"
                                            en="'API_TRANSLATION.DRILL_CORE.DEPOSITORY__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.depository__value" en="detailCtrl.results.depository__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.storage__location && detailCtrl.results.storage__location != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.STORAGE__LOCATION ' | translate }} </td>
                        <td> {{detailCtrl.results.storage__location }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.agent__agent && detailCtrl.results.agent__agent != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.AGENT__AGENT ' | translate }} </td>
                        <td> {{ detailCtrl.results.agent__agent }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.year && detailCtrl.results.year != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.YEAR ' | translate }} </td>
                        <td> {{ detailCtrl.results.year }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.depth && detailCtrl.results.depth != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.DEPTH ' | translate }} </td>
                        <td> {{ detailCtrl.results.depth }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.number_meters && detailCtrl.results.number_meters != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.NUMBER_METERS ' | translate }} </td>
                        <td> {{ detailCtrl.results.number_meters }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.remarks && detailCtrl.results.remarks != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.REMARKS ' | translate }} </td>
                        <td> {{ detailCtrl.results.remarks }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.locality__maaamet_pa_id && detailCtrl.results.locality__maaamet_pa_id != null" >
                        <td> {{ 'API_TRANSLATION.DRILL_CORE.LOCALITY__MAAAMET_PA_ID ' | translate }} </td>
                        <td> {{ detailCtrl.results.locality__maaamet_pa_id }} </td>
                    </tr>

                </table>
            </div>

            <div class="col-sm-6" data-ng-if="detailCtrl.locality.latitude && detailCtrl.locality.longitude">
                <h3> {{ 'DETAIL.DETAIL_MAP' | translate }} </h3>
                <div id='hoverbox' class='coupontooltip'>
                    <div id='hoversystem'></div>
                    <div id='hoverstat'></div>
                </div>
                <locality-map x = "detailCtrl.locality.latitude" y = "detailCtrl.locality.longitude" name = "detailCtrl.locality.localityEn" fid = "detailCtrl.locality.localityId"></locality-map>
                <a href data-ng-click="detailCtrl.service.showGoogleMap(detailCtrl.locality.latitude, detailCtrl.locality.longitude, detailCtrl.locality.localityEn)">Google Maps</a></span>
                &ensp;&ensp;|&ensp;&ensp; <a href data-ng-click="detailCtrl.service.showEstonianLandBoardMap(detailCtrl.locality.latitude, detailCtrl.locality.longitude)">Maa-amet / Estonian Land Board</a>
            </div>

        </div>

        <div class="row">

            <div class="col-sm-12" data-ng-if="detailCtrl.attachment.length > 0">
                <h3>{{ 'DETAIL.DRILLCORE.DRILLCORE_BOXES'| translate }}</h3>

                <!-- Depends on box direction -->
                <table class="table-bordered table-hover"
                       ng-class="detailCtrl.results.direction_lr ? 'drillcore-tables' : 'drillcore-tables-rl'"
                       data-ng-repeat="box in detailCtrl.attachment | orderBy: 'id'"
                       data-ng-if="box.uuid_filename != null">

                    <tbody>
                        <tr>
                            <td id="drillcore-box-heading" colspan="2">
                                <h4>{{ 'DETAIL.DRILLCORE.BOX_NUMBER'| translate }} {{box.drillcore_box__number}}</h4>
                            </td>
                        </tr>

                        <tr>
                            <td>{{ 'DETAIL.DRILLCORE.SINCE'| translate }}</td>
                            <td>
                                <div class="table-data-min-height">
                                    {{box.drillcore_box__depth_start}}
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td>{{ 'DETAIL.DRILLCORE.TO'| translate }}</td>
                            <td>
                                <div class="table-data-min-height">
                                    {{box.drillcore_box__depth_end}}
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td>{{ 'DETAIL.DRILLCORE.STRATIGRAPHY_TOP'| translate }}</td>
                            <td>
                                <div class="table-data-min-height">
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: box.stratigraphy_top_id})">
                                        <localize et="box.stratigraphy_top__stratigraphy" en="box.stratigraphy_top__stratigraphy_en" />
                                    </a>
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td>{{ 'DETAIL.DRILLCORE.STRATIGRAPHY_BASE'| translate }}</td>
                            <td>
                                <div class="table-data-min-height">
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: box.stratigraphy_base_id})">
                                        <localize et="box.stratigraphy_base__stratigraphy" en="box.stratigraphy_base__stratigraphy_en" />
                                    </a>
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td id="drillcore-image-background" colspan="2">
                                <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'corebox',id:box.drillcore_box__id})">
                                    <img  data-toggle="tooltip" title="{{ 'DETAIL.DRILLCORE.COREBOX_DETAILS' | translate }}"
                                         ng-src="{{detailCtrl.service.getFileLink({size: 'small', filename: box.uuid_filename})}}" />
                                </a>
                            </td>
                        </tr>

                        <tr>
                            <td id="core-box-author" colspan="2">{{box.author__agent}} | {{box.date_created | date:dateFormat}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </div>

    </div>

    <div data-ng-if="detailCtrl.results == null && pageHasError" ng-include="'app/templates/main/detailview_error.html'"></div>

</div>

<div ng-include="'app/templates/main/partial/detailview_footer.html'"></div>

<script>
    $(function(){
        $('#elementToFocus').focus();
    });
</script>