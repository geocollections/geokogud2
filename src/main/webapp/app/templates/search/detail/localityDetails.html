<div ng-include="'app/templates/main/partial/detailview_header.html'"></div>

<!--<div id="elementToFocus" tabindex="1" style="outline: 0" ng-arrow-left="detailCtrl.reload({table:'locality', left:true})" ng-arrow-right="detailCtrl.reload({table:'locality', right:true})"  class="panel detailview-page">-->
<div class="panel detailview-page">
    <div class="panel-body detailview-max-width" data-ng-if="detailCtrl.results != null">

        <div class="row">
            <div class="col-sm-12">
                <div class="detailview-title">
                    <h2>
                        {{'API_TRANSLATION.LOCALITY.DETAIL_FORM_NAME' | translate }}
                        <localize et="detailCtrl.results.locality" en="detailCtrl.results.locality_en"/>
                    </h2>
                    <div>
                        <em>(ID: {{detailCtrl.results.id}})</em>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6" bs-loading-overlay bs-loading-overlay-reference-id="detailView" bs-loading-overlay-template-url="app/templates/main/partial/loading.overlay.html">

                <h3> {{ 'DETAILVIEW_TABLE_HEADER' | translate }} </h3>
                <table class="table table-bordered table-hover table-header-styles">

                    <tr data-ng-if="(detailCtrl.results.locality && detailCtrl.results.locality != null)
                        || (detailCtrl.results.locality_en && detailCtrl.results.locality_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.LOCALITY'" en="'API_TRANSLATION.LOCALITY.LOCALITY_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.locality" en="detailCtrl.results.locality_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.number && detailCtrl.results.number != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.NUMBER ' |translate }} </td>
                        <td> {{ detailCtrl.results.number }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.type__value && detailCtrl.results.type__value != null)
                        || (detailCtrl.results.type__value_en && detailCtrl.results.type__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.TYPE__VALUE'" en="'API_TRANSLATION.LOCALITY.TYPE__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.type__value" en="detailCtrl.results.type__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.country__value && detailCtrl.results.country__value != null)
                        || (detailCtrl.results.country__value_en && detailCtrl.results.country__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.COUNTRY__VALUE'" en="'API_TRANSLATION.LOCALITY.COUNTRY__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.country__value" en="detailCtrl.results.country__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.maakond__maakond && detailCtrl.results.maakond__maakond != null)
                        || (detailCtrl.results.maakond__maakond_en && detailCtrl.results.maakond__maakond_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.MAAKOND__MAAKOND'"
                                            en="'API_TRANSLATION.LOCALITY.MAAKOND__MAAKOND_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.maakond__maakond" en="detailCtrl.results.maakond__maakond_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.vald__vald && detailCtrl.results.vald__vald != null)
                        || (detailCtrl.results.vald__vald_en && detailCtrl.results.vald__vald_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.VALD__VALD'" en="'API_TRANSLATION.LOCALITY.VALD__VALD_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.vald__vald" en="detailCtrl.results.vald__vald_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.asustusyksus__asustusyksus && detailCtrl.results.asustusyksus__asustusyksus != null)
                        || (detailCtrl.results.asustusyksus__asustusyksus_en && detailCtrl.results.asustusyksus__asustusyksus_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.ASUSTUSYKSUS__ASUSTUSYKSUS'"
                                            en="'API_TRANSLATION.LOCALITY.ASUSTUSYKSUS__ASUSTUSYKSUS_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.asustusyksus__asustusyksus" en="detailCtrl.results.asustusyksus__asustusyksus_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.elevation && detailCtrl.results.elevation != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.ELEVATION ' | translate }} </td>
                        <td> {{ detailCtrl.results.elevation }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.latitude && detailCtrl.results.latitude != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.LATITUDE ' | translate }} </td>
                        <td> {{ detailCtrl.results.latitude }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.longitude && detailCtrl.results.longitude != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.LONGITUDE ' | translate }} </td>
                        <td> {{ detailCtrl.results.longitude }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.coord_system && detailCtrl.results.coord_system != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.COORD_SYSTEM ' | translate }} </td>
                        <td> {{ detailCtrl.results.coord_system }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.coordx && detailCtrl.results.coordx != null">
                        <td> {{'API_TRANSLATION.LOCALITY.COORDX ' | translate }} </td>
                        <td> {{ detailCtrl.results.coordx }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.coordy && detailCtrl.results.coordy != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.COORDY ' | translate }} </td>
                        <td> {{ detailCtrl.results.coordy }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.coord_det_precision__value && detailCtrl.results.coord_det_precision__value != null">
                        <td> {{'API_TRANSLATION.LOCALITY.COORD_DET_PRECISION__VALUE ' | translate }} </td>
                        <td> {{ detailCtrl.results.coord_det_precision__value }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.coord_det_method__value && detailCtrl.results.coord_det_method__value != null)
                        || (detailCtrl.results.coord_det_method__value_en && detailCtrl.results.coord_det_method__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.COORD_DET_METHOD__VALUE'"
                                            en="'API_TRANSLATION.LOCALITY.COORD_DET_METHOD__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.coord_det_method__value" en="detailCtrl.results.coord_det_method__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.coord_det_agent__agent && detailCtrl.results.coord_det_agent__agent != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.COORD_DET_AGENT__AGENT ' | translate }} </td>
                        <td> {{ detailCtrl.results.coord_det_agent__agent }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.parent__locality && detailCtrl.results.parent__locality != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.PARENT__LOCALITY ' | translate }} </td>
                        <td> {{ detailCtrl.results.parent__locality }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.remarks_location && detailCtrl.results.remarks_location != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.REMARKS_LOCATION ' |translate }} </td>
                        <td> {{ detailCtrl.results.remarks_location }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.depth && detailCtrl.results.depth != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.DEPTH ' | translate }} </td>
                        <td> {{ detailCtrl.results.depth }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.stratigraphy_top__stratigraphy && detailCtrl.results.stratigraphy_top__stratigraphy != null)
                        || (detailCtrl.results.stratigraphy_top__stratigraphy_en && detailCtrl.results.stratigraphy_top__stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.STRATIGRAPHY_TOP__STRATIGRAPHY'"
                                            en="'API_TRANSLATION.LOCALITY.STRATIGRAPHY_TOP__STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: detailCtrl.results.stratigraphy_top_id})">
                                <localize et="detailCtrl.results.stratigraphy_top__stratigraphy"
                                          en="detailCtrl.results.stratigraphy_top__stratigraphy_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.stratigraphy_top_free && detailCtrl.results.stratigraphy_top_free != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_TOP_FREE ' |translate }} </td>
                        <td> {{ detailCtrl.results.stratigraphy_top_free }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.stratigraphy_base__stratigraphy && detailCtrl.results.stratigraphy_base__stratigraphy != null)
                        || (detailCtrl.results.stratigraphy_base__stratigraphy_en && detailCtrl.results.stratigraphy_base__stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.LOCALITY.STRATIGRAPHY_BASE__STRATIGRAPHY'"
                                            en="'API_TRANSLATION.LOCALITY.STRATIGRAPHY_BASE__STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: detailCtrl.results.stratigraphy_base_id})">
                                <localize et="detailCtrl.results.stratigraphy_base__stratigraphy"
                                          en="detailCtrl.results.stratigraphy_base__stratigraphy_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.stratigraphy_base_free && detailCtrl.results.stratigraphy_base_free != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_BASE_FREE ' |translate }} </td>
                        <td> {{ detailCtrl.results.stratigraphy_base_free }} </td>
                    </tr>
                    
                    <tr data-ng-if="detailCtrl.drillcores.length > 0" ng-repeat="entity in detailCtrl.drillcores | limitTo:1">
                        <td> {{ 'API_TRANSLATION.LOCALITY.DRILLCORE' | translate }} </td>
                        <td data-ng-if="entity.boxes != null">
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'drillcore',id:entity.id})">
                                {{entity.boxes}} {{ 'API_TRANSLATION.LOCALITY.COREBOX' | translate }}
                            </a>
                        </td>
                        <td data-ng-if="entity.boxes == null">
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'drillcore',id:entity.id})">
                                0 {{ 'API_TRANSLATION.LOCALITY.COREBOX' | translate }}
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.localitystratigraphy__stratigraphy__stratigraphy_en
                        && detailCtrl.results.localitystratigraphy__stratigraphy__stratigraphy_en != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.LOCALITYSTRATIGRAPHY__STRATIGRAPHY__STRATIGRAPHY_EN ' | translate }}</td>
                        <td> {{ detailCtrl.results.localitystratigraphy__stratigraphy__stratigraphy_en }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.maaamet_pa_id && detailCtrl.results.maaamet_pa_id != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.MAAAMET_PA_ID ' | translate }} </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url:'http://geoportaal.maaamet.ee/index.php?&action=viewPA&page_id=382&pa_id='+detailCtrl.results.maaamet_pa_id})">
                                {{ detailCtrl.results.maaamet_pa_id }}
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.eelis && detailCtrl.results.eelis != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.EELIS ' | translate }} </td>
                        <td> {{ detailCtrl.results.eelis }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.remarks && detailCtrl.results.remarks != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.REMARKS ' | translate }} </td>
                        <td> {{ detailCtrl.results.remarks }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.user_added && detailCtrl.results.user_added != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.USER_ADDED ' | translate }} </td>
                        <td> {{ detailCtrl.results.user_added }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.date_added && detailCtrl.results.date_added != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.DATE_ADDED ' | translate }} </td>
                        <td> {{ detailCtrl.results.date_added | date:dateFormat }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.date_changed && detailCtrl.results.date_changed != null">
                        <td> {{ 'API_TRANSLATION.LOCALITY.DATE_CHANGED ' | translate }} </td>
                        <td> {{ detailCtrl.results.date_changed | date:dateFormat }} </td>
                    </tr>

                </table>

                <!-- Stratigraphy stratotypes -->
                <div data-ng-if="detailCtrl.stratigraphyStratotype.length > 0">
                    <h3> {{ 'DETAIL.DETAIL_STRATIGRAPHY_STRATOTYPE' | translate }} </h3>

                    <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                            <thead class="styles-for-table-headers">
                            <tr>
                                <th>{{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_STRATOTYPE.STRATIGRAPHY' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_STRATOTYPE.TYPE' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_STRATOTYPE.DEPTH' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_STRATOTYPE.REFERENCE' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.LOCALITY.STRATIGRAPHY_STRATOTYPE.REMARKS' | translate }}</th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr data-ng-repeat="entity in detailCtrl.stratigraphyStratotype">
                                <td>
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: entity.stratigraphy__id})">
                                        <localize et="entity.stratigraphy__stratigraphy" en="entity.stratigraphy__stratigraphy_en" />
                                    </a>
                                </td>
                                <td>
                                    <localize et="entity.stratotype_type__value" en="entity.stratotype_type__value_en" />
                                </td>
                                <td>
                                    {{ entity.depth_top }}<span ng-show="entity.depth_base != null && entity.depth_top != null">..</span>{{entity.depth_base }}
                                </td>
                                <td>
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'reference', id: entity.reference__id})">
                                        {{ entity.reference__reference }}
                                    </a>
                                </td>
                                <td> {{ entity.remarks }} </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                </div>

                <!-- Related files -->
                <div data-ng-if="detailCtrl.attachmentLink.length > 0">
                    <h3> {{ 'DETAIL.DETAIL_ATTACHMENT_LINK' | translate }} </h3>

                    <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                            <thead class="styles-for-table-headers">
                            <tr>
                                <th>{{ 'API_TRANSLATION.SAMPLE.ATTACHMENT_LINK.TYPE' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.SAMPLE.ATTACHMENT_LINK.DESCRIPTION' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.SAMPLE.ATTACHMENT_LINK.AUTHOR' | translate }}</th>
                                <th>{{ 'API_TRANSLATION.SAMPLE.ATTACHMENT_LINK.DATE' | translate }}</th>
                                <th></th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr data-ng-repeat="entity in detailCtrl.attachmentLink">
                                <td>
                                    <localize et="entity.attachment__type__value" en="entity.attachment__type__value_en" />
                                </td>
                                <td>
                                    <localize et="entity.attachment__description" en="entity.attachment__description_en" />
                                </td>
                                <td>
                                    <first-not-null values="[entity.attachment__author__agent, entity.attachment__author_free]" />
                                </td>
                                <td>
                                    <span data-ng-if="entity.attachment__date_added != null">
                                        {{ entity.attachment__date_added | date:dateFormat }}
                                    </span>
                                        <span data-ng-if="entity.attachment__date_added == null && entity.attachment__date_created != null">
                                        {{ entity.attachment__date_created | date:dateFormat }}
                                    </span>
                                        <span data-ng-if="entity.attachment__date_added == null && entity.attachment__date_created == null && entity.attachment__date_created_free != null">
                                        {{ entity.attachment__date_created_free }}
                                    </span>
                                </td>
                                <td>
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'file', id: entity.attachment__id})">
                                        Link
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Related images -->
                <div data-ng-if="detailCtrl.attachmentLink.length > 0">
                    <!--<h3> {{ 'DETAIL.LOCALITY.IMAGES_HEADING_2'| translate }} </h3>-->

                    <div class="row related-images-margin-top">

                        <div class="col-md-6 col-xs-6" data-ng-repeat="image in detailCtrl.attachmentLink"
                             data-ng-if="image.attachment__filename.endsWith('png') || image.attachment__filename.endsWith('jpeg') || image.attachment__filename.endsWith('svg') || image.attachment__filename.endsWith('jpg')" >

                            <figure class="margin-bottom-30">

                                <a href="{{detailCtrl.service.getFileLink({size: 'large', filename: image.attachment__uuid_filename})}}" class="hover-me" data-fancybox="gallery">

                                    <div class="img-responsive set-height">
                                        <img class="previewImageDetail img-rounded"
                                             src="{{detailCtrl.service.getFileLink({size: 'small', filename: image.attachment__uuid_filename})}}" />
                                    </div>

                                    <!--<show-preview class="img-responsive set-height"-->
                                    <!--classes="previewImageDetail img-rounded"-->
                                    <!--img-title="[image.author__agent, image.date_taken, image.date_taken_free]"-->
                                    <!--img-url="detailCtrl.service.getDownloadLink(image.attachment__filename)" />-->

                                </a>

                            </figure>

                        </div>

                    </div>
                </div>

            </div>

            <div class="col-sm-6">

                <!-- Map -->
                <div data-ng-if="detailCtrl.locality.latitude && detailCtrl.locality.longitude">
                    <h3> {{ 'DETAIL.DETAIL_MAP' | translate }} </h3>
                    <div id='hoverbox' class='coupontooltip'>
                        <div id='hoversystem'></div>
                        <div id='hoverstat'></div>
                    </div>
                    <locality-map x = "detailCtrl.locality.latitude" y = "detailCtrl.locality.longitude" name = "detailCtrl.locality.localityEn" fid = "detailCtrl.locality.localityId"></locality-map>
                    <a href data-ng-click="detailCtrl.service.showGoogleMap(detailCtrl.locality.latitude, detailCtrl.locality.longitude, detailCtrl.locality.localityEn)">Google Maps</a></span>
                    &ensp;&ensp;|&ensp;&ensp; <a href data-ng-click="detailCtrl.service.showEstonianLandBoardMap(detailCtrl.locality.latitude, detailCtrl.locality.longitude)">Maa-amet / Estonian Land Board</a>
                </div>

                <!-- Images -->
                <div data-ng-if="detailCtrl.attachment.length > 0 && doesAttachmentTableContainImages()">
                    <h3> {{ 'DETAIL.LOCALITY.IMAGES_HEADING'| translate }} </h3>

                    <div class="row">

                        <div class="col-md-6 col-xs-6" data-ng-repeat="image in detailCtrl.attachment" data-ng-if="image.specimen_image_attachment === 2">

                            <figure class="margin-bottom-30">

                                <a href="{{detailCtrl.service.getFileLink({size: 'large', filename: image.uuid_filename})}}" class="hover-me" data-fancybox="gallery"
                                   data-caption="{{detailCtrl.service.setFancyBoxCaption(
                                       {
                                            author: image.author__agent,
                                            author_free: image.author_free,
                                            date_taken: image.date_created,
                                            date_taken_free: image.date_created_free,
                                            copyright_agent: image.copyright_agent__agent,
                                            licence: image.licence__licence_en,
                                            licence_url: image.licence__licence_url,
                                            licence_url_en: image.licence__licence_url_en,
                                            id: image.id
                                       })}}">

                                    <show-preview class="img-responsive set-height"
                                                  classes="previewImageDetail img-rounded"
                                                  img-title="[image.author__agent, image.date_created, image.date_created_free]"
                                                  img-url="detailCtrl.service.getFileLink({size: 'small', filename: image.uuid_filename})" />

                                </a>

                            </figure>

                        </div>

                    </div>

                </div>

                <!-- Synonyms -->
                <div data-ng-if="detailCtrl.localitySynonyms.length > 0">
                    <h3> {{ 'DETAIL.LOCALITY.SYNONYMS_HEADING' | translate }} </h3>
                    <table class="table table-bordered table-hover">
                        <thead class="styles-for-table-headers">
                        <tr>
                            <th> {{ 'DETAIL.LOCALITY.NAME' | translate }} </th>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE' | translate }} </th>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE_PAGES' | translate }} </th>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE_REMARKS' | translate }} </th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr data-ng-repeat="entity in detailCtrl.localitySynonyms" data-ng-if="entity.synonym && entity.synonym != null">
                            <td>{{entity.synonym}}</td>
                            <td>{{entity.reference__reference}}</td>
                            <td>{{entity.pages}}</td>
                            <td>{{entity.remarks}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Specimens + link -->
                <div data-ng-if="detailCtrl.relatedSpecimens.length > 0">
                    <h3> {{ 'DETAIL.LOCALITY.SPECIMEN' | translate }} </h3>

                    <!-- Pagination -->
                    <div class="search-pagination">
                        <nav class="pull-right">
                            <ul uib-pagination
                                boundary-links="true"
                                ng-change="searchRelatedSpecimens()"
                                items-per-page="10"
                                max-size="5"
                                total-items="detailCtrl.relatedSpecimensCount"
                                ng-model="specimenPage"
                                class="pagination-sm"
                                style="margin-bottom: 10px; margin-top: 0"
                                first-text="&laquo;"
                                previous-text="&lsaquo;"
                                next-text="&rsaquo;"
                                last-text="&raquo;"></ul>
                        </nav>
                    </div>

                    <table class="table table-bordered table-hover margin-bottom-5">
                        <thead class="styles-for-table-headers">
                            <tr>
                                <th> {{ 'DETAIL.LOCALITY.ID' | translate }} </th>
                                <th> {{ 'DETAIL.LOCALITY.NAME' | translate }} </th>
                                <th> {{ 'DETAIL.LOCALITY.STRATIGRAPHY' | translate }} </th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr data-ng-repeat="specimen in detailCtrl.relatedSpecimens track by $index">
                            <!--<tr data-ng-repeat="specimen in detailCtrl.results.specimens.results" data-ng-if="specimen.specimenidentification__current == true || specimen.specimenidentificationgeologies__current == true" >-->

                                <td data-ng-if="specimen.id != null">
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'specimen',id:specimen.id})">
                                        {{specimen.id}}
                                    </a>
                                </td>

                                <td>
                                    <!-- specimen_identification -->
                                    <span data-ng-if="detailCtrl.relatedSpecimenIdentfication.length > 0">

                                        <span data-ng-repeat="taxon in detailCtrl.relatedSpecimenIdentfication">
                                            <span data-ng-if="specimen.id === taxon.specimen_id">

                                                <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url:'http://fossiilid.info/' + taxon.taxon_id})">
                                                    <span data-ng-if="taxon.taxon__taxon && taxon.taxon__taxon != null">
                                                        {{ taxon.taxon__taxon }}
                                                    </span>

                                                    <span data-ng-if="taxon.taxon__taxon === null && (taxon.name && taxon.name !== null)">
                                                        {{ taxon.name }}
                                                    </span>
                                                </a>

                                            </span>
                                        </span>
                                    </span>

                                    <!-- TODO: Enable if it is possible to be both TAXON or ROCK -->
                                    <!--<span data-ng-if="(detailCtrl.relatedSpecimenIdentfication.length > 0 && detailCtrl.relatedSpecimenIdentficationGeology.length > 0)-->
                                        <!--&& (detailCtrl.relatedSpecimenIdentfication[$index].taxon_id != null || detailCtrl.relatedSpecimenIdentficationGeology[$index].rock_id != null)">-->
                                        <!--|-->
                                    <!--</span>-->

                                    <!-- specimen_identification_geology -->
                                    <span data-ng-if="detailCtrl.relatedSpecimenIdentficationGeology.length > 0">

                                        <span data-ng-repeat="rock in detailCtrl.relatedSpecimenIdentficationGeology">
                                            <span data-ng-if="specimen.id === rock.specimen_id">

                                                <a href data-ng-if="rock.rock_id != null"
                                                   data-ng-click="detailCtrl.service.openUrlInNewWindow({url: 'http://www.kivid.info/' + rock.rock_id})">
                                                    <span data-ng-if="(rock.name && rock.name != null) || (rock.name_en && rock.name_en != null)">
                                                        <localize et="rock.name" en="rock.name_en" />
                                                    </span>

                                                    <span data-ng-if="(rock.name === null && rock.name_en === null)
                                                        && ((rock.rock__name && rock.rock__name != null) || (rock.rock__name_en && rock.rock__name_en != null))">
                                                        <localize et="rock.rock__name" en="rock.rock__name_en" />
                                                    </span>

                                                </a>

                                            </span>
                                        </span>
                                    </span>
                                </td>

                                <td>
                                    <a data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: specimen.stratigraphy_id})"
                                       href ng-if="specimen.stratigraphy_id != null">
                                        <localize et="specimen.stratigraphy__stratigraphy" en="specimen.stratigraphy__stratigraphy_en" />
                                    </a>
                                </td>
                            </tr>
                        </tbody>

                    </table>

                    <a href data-ng-click="detailCtrl.service.searchAllSpecimenInLocality({locality: detailCtrl.results.locality, localityEn: detailCtrl.results.locality_en})" target="_blank">
                        {{ 'DETAIL.LOCALITY.ALL_SPECIMEN' | translate}} ({{detailCtrl.relatedSpecimensCount}})
                    </a>
                </div>

                <!-- References -->
                <div data-ng-if="detailCtrl.localityReferences.length > 0">
                    <h3> {{ 'DETAIL.LOCALITY.REFERENCE_HEADING' | translate }} </h3>
                    <table class="table table-bordered table-hover">
                        <thead class="styles-for-table-headers">
                        <tr>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE' | translate }} </th>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE_PAGES' | translate }} </th>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE_FIGURES' | translate }} </th>
                            <th> {{ 'DETAIL.LOCALITY.REFERENCE_REMARKS' | translate }} </th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr data-ng-repeat="entity in detailCtrl.localityReferences">
                            <td>
                                <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'reference', id: entity.reference_id})">{{entity.reference__reference}}</a>
                            <td>{{ entity.pages }}</td>
                            <td>{{ entity.figures }}</td>
                            <td>{{ entity.remarks }}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Samples link -->
                <div data-ng-if="detailCtrl.relatedSamples.length > 0">

                    <!--TODO: Sample table, same like specimens-->

                    <a href target="_blank" data-ng-click="detailCtrl.service.searchAllSamplesUsingLocality({locality: detailCtrl.results.locality, localityEn: detailCtrl.results.locality_en})">
                        {{ 'DETAIL.LOCALITY.SAMPLE_LINK' | translate }} ({{detailCtrl.relatedSamplesCount}})
                    </a>
                </div>

            </div>
        </div>

    </div>

    <div data-ng-if="detailCtrl.results == null && pageHasError" ng-include="'app/templates/main/detailview_error.html'"></div>

</div>

<div ng-include="'app/templates/main/partial/detailview_footer.html'"></div>