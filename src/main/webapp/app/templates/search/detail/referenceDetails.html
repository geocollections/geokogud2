<div ng-include="'app/templates/main/partial/detailview_header.html'"></div>

<div id="elementToFocus" tabindex="1" style="outline: 0" ng-arrow-left="detailCtrl.reload({table:'reference', left:true})" ng-arrow-right="detailCtrl.reload({table:'reference', right:true})"  class="panel detailview-page">
    <div class="panel-body" data-ng-if="detailCtrl.results != null">

        <div class="row">
            <div class="col-lg-6" bs-loading-overlay bs-loading-overlay-reference-id="detailView" bs-loading-overlay-template-url="app/templates/main/partial/loading.overlay.html">

                <div class="detailview-title">
                    <h2>
                        <localize et="detailCtrl.results.reference" en="null"/>
                    </h2>
                </div>

                <h3> {{ 'DETAILVIEW_TABLE_HEADER' | translate }} </h3>
                <table class="table table-bordered table-hover table-header-styles">

                    <tr data-ng-if="detailCtrl.results.id && detailCtrl.results.id != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.ID ' | translate }} </td>
                        <td> {{ detailCtrl.results.id }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.reference && detailCtrl.results.reference != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.REFERENCE ' | translate }} </td>
                        <td> {{ detailCtrl.results.reference }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.author && detailCtrl.results.author != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.AUTHOR ' | translate }} </td>
                        <td> {{ detailCtrl.results.author }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.year && detailCtrl.results.year != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.YEAR ' | translate }} </td>
                        <td> {{ detailCtrl.results.year }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.title && detailCtrl.results.title != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.TITLE ' | translate }} </td>
                        <td> {{ detailCtrl.results.title }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.title_original && detailCtrl.results.title_original != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.TITLE_ORIGINAL ' | translate }} </td>
                        <td> {{ detailCtrl.results.title_original }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.book && detailCtrl.results.book != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.BOOK ' | translate }} </td>
                        <td> {{ detailCtrl.results.book }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.book_original && detailCtrl.results.book_original != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.BOOK ' | translate }} </td>
                        <td> {{ detailCtrl.results.book_original }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.publisher && detailCtrl.results.publisher != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.PUBLISHER' | translate }} </td>
                        <td> {{ detailCtrl.results.publisher }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.publisher_place && detailCtrl.results.publisher_place != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.PUBLISHER_PLACE' | translate }} </td>
                        <td> {{ detailCtrl.results.publisher_place }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.journal__journal_name && detailCtrl.results.journal__journal_name != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.JOURNAL__JOURNAL_NAME ' | translate }} </td>
                        <td> {{ detailCtrl.results.journal__journal_name }} </td>
                    </tr>


                    <tr data-ng-if="detailCtrl.results.journal_additional && detailCtrl.results.journal_additional != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.JOURNAL_ADDITIONAL ' | translate }} </td>
                        <td> {{ detailCtrl.results.journal_additional }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.volume && detailCtrl.results.volume != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.VOLUME ' | translate }} </td>
                        <td> {{ detailCtrl.results.volume }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.number && detailCtrl.results.number != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.NUMBER' | translate }} </td>
                        <td> {{ detailCtrl.results.number }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.pages && detailCtrl.results.pages != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.PAGES ' | translate }} </td>
                        <td> {{ detailCtrl.results.pages }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.type__value && detailCtrl.results.type__value != null)
                        || (detailCtrl.results.type__value_en && detailCtrl.results.type__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.REFERENCE.TYPE__VALUE'" en="'API_TRANSLATION.REFERENCE.TYPE__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.type__value" en="detailCtrl.results.type__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.language__value && detailCtrl.results.language__value != null)
                        || (detailCtrl.results.language__value_en && detailCtrl.results.language__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.REFERENCE.LANGUAGE__VALUE'"
                                            en="'API_TRANSLATION.REFERENCE.LANGUAGE__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.language__value" en="detailCtrl.results.language__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.remarks && detailCtrl.results.remarks != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.REMARKS ' | translate }} </td>
                        <td> {{ detailCtrl.results.remarks }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.doi && detailCtrl.results.doi != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.DOI ' | translate }} </td>
                        <td>
                            <a href data-ng-if="detailCtrl.results.doi && detailCtrl.results.doi != null"
                               data-ng-click="detailCtrl.service.openDoiInNewWindow({doi: detailCtrl.results.doi})">
                                {{ detailCtrl.results.doi }}
                                <!--<i title="{{detailCtrl.results.doi}}" class="fa fa-file-text-o fa-2x" aria-hidden="true"></i>-->
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.url && detailCtrl.results.url != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.URL' | translate }} </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url: detailCtrl.results.url})">
                                {{detailCtrl.results.url}}
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.abstract && detailCtrl.results.abstract != null">
                        <td> {{ 'API_TRANSLATION.REFERENCE.ABSTRACT' | translate }} </td>
                        <td> {{ detailCtrl.results.abstract }} </td>
                    </tr>

                </table>
            </div>

            <!-- Doi -->
            <div class="col-lg-6" data-ng-if="detailCtrl.doi.length > 0">
                <h3> {{ 'API_TRANSLATION.REFERENCE.DOI.HEADING' | translate }} </h3>

                <div class="table-responsive">
                    <table class="table table-hover table-bordered">
                        <thead class="styles-for-table-headers">
                        <tr>
                            <th> {{ 'API_TRANSLATION.REFERENCE.DOI.DOI' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.DOI.AUTHOR' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.DOI.DATE' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.DOI.TITLE' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.DOI.FORMAT' | translate }} </th>
                            <th></th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr data-ng-repeat="entity in detailCtrl.doi">
                            <td>
                                <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'doi', id: entity.id})">
                                    {{ entity.identifier }}
                                </a>
                            </td>
                            <td> {{ entity.creators }} </td>
                            <td> {{ entity.date_added | date:dateFormat }} </td>
                            <td> {{ entity.title }} </td>
                            <td> {{ entity.formats }} </td>
                            <td> {{ entity.sizes }} </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Related files -->
            <div class="col-lg-6" data-ng-if="detailCtrl.attachmentLink.length > 0">
                <h3> {{ 'API_TRANSLATION.REFERENCE.LINKED_FILES' | translate }} </h3>

                <div class="table-responsive">
                    <table class="table table-hover table-bordered">
                        <thead class="styles-for-table-headers">
                        <tr>
                            <th> {{ 'API_TRANSLATION.REFERENCE.ID' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.TYPE' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.DESCRIPTION' | translate }} </th>
                            <th></th>
                            <!--<th> {{ 'API_TRANSLATION.REFERENCE.PREVIEW' | translate }} </th>-->
                        </tr>
                        </thead>

                        <tbody>
                        <tr data-ng-repeat="entity in detailCtrl.attachmentLink">
                            <td> {{ entity.attachment__id }} </td>
                            <td data-ng-if="entity.locality__id === null && entity.locality__locality != null && entity.locality__locality_id != null">
                                <localize en="entity.locality__locality_en" et="entity.locality__locality" />

                            </td>
                            <td>
                                <a href data-ng-if="entity.attachment__id != null"
                                   data-ng-click="detailCtrl.service.openInNewWindow({object: 'attachment', id: entity.attachment__id})">
                                    <localize et="entity.attachment__type__value" en="entity.attachment__type__value_en" />
                                </a>
                            </td>
                            <td>
                                <localize et="entity.attachment__description" en="entity.attachment__description_en" />
                            </td>

                            <td>
                                <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'attachment', id: entity.attachment__id})">
                                    Link
                                </a>
                            </td>
                            <!--<td class="text-center">-->
                            <!--<a target="_blank" ng-href="{{detailCtrl.service.getDownloadLink(entity.attachment__filename)}}">-->
                            <!--<i data-ng-if="entity.attachment__filename.endsWith('pdf')"-->
                            <!--title="{{detailCtrl.service.getDownloadLink(entity.attachment__filename)}}"-->
                            <!--class="fa fa-file-pdf-o fa-2x" aria-hidden="true"></i>-->

                            <!--<i data-ng-if="entity.attachment__filename.endsWith('txt')"-->
                            <!--title="{{detailCtrl.service.getDownloadLink(entity.attachment__filename)}}"-->
                            <!--class="fa fa-file-text-o fa-2x" aria-hidden="true"></i>-->

                            <!--<i data-ng-if="entity.attachment__filename.endsWith('xlsx') || entity.attachment__filename.endsWith('ods') || entity.attachment__filename.endsWith('xls')"-->
                            <!--title="{{detailCtrl.service.getDownloadLink(entity.attachment__filename)}}"-->
                            <!--class="fa fa-file-excel-o fa-2x" aria-hidden="true"></i>-->

                            <!--<img title="{{detailCtrl.service.getDownloadLink(entity.attachment__filename)}}"-->
                            <!--data-ng-if="entity.attachment__filename.endsWith('png') || entity.attachment__filename.endsWith('jpeg') || entity.attachment__filename.endsWith('svg') || entity.attachment__filename.endsWith('jpg')"-->
                            <!--class="previewImage"-->
                            <!--src="{{detailCtrl.service.getDownloadLink(entity.attachment__filename)}}"/>-->
                            <!--</a>-->
                            <!--</td>-->
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Related images -->
            <div class="col-lg-6" data-ng-if="detailCtrl.attachmentLink.length > 0">
                <!--<h3> {{ 'DETAIL.LOCALITY.IMAGES_HEADING'| translate }} </h3>-->

                <div class="row related-images-margin-top">

                    <div class="col-md-6 col-xs-6" data-ng-repeat="image in detailCtrl.attachmentLink"
                         data-ng-if="image.attachment__filename.endsWith('png') || image.attachment__filename.endsWith('jpeg') || image.attachment__filename.endsWith('svg') || image.attachment__filename.endsWith('jpg')" >

                        <figure class="margin-bottom-30">

                            <a href="{{detailCtrl.service.getDownloadLink(image.attachment__filename)}}" class="hover-me" data-fancybox="gallery">

                                <div class="img-responsive set-height">
                                    <img class="previewImageDetail img-rounded"
                                         src="{{detailCtrl.service.getDownloadLink(image.attachment__filename)}}" />
                                </div>

                                <!--<show-preview class="img-responsive set-height"-->
                                <!--classes="previewImageDetail img-rounded"-->
                                <!--img-title="[image.author__agent, image.date_taken, image.date_taken_free]"-->
                                <!--img-url="detailCtrl.service.getDownloadLink(image.attachment__filename)" />-->

                            </a>

                        </figure>

                    </div>

                </div>
            </div>

            <!-- Localities -->
            <div class="col-lg-6" data-ng-if="detailCtrl.localityReferences.length > 0">
                <h3> {{ 'API_TRANSLATION.REFERENCE.SECTIONS_DESCRIBED' | translate }} </h3>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered">
                        <thead class="styles-for-table-headers">
                            <tr>
                                <th> {{ 'API_TRANSLATION.REFERENCE.LOCALITY' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.REFERENCE.LOCALITY_PAGES' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.REFERENCE.FIGURES' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.REFERENCE.REMARKS' | translate }} </th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr data-ng-repeat="entity in detailCtrl.localityReferences">
                                <td data-ng-if="(entity.locality__id && entity.locality__id != null)
                                    && entity.locality__locality && entity.locality__locality != null">
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'locality', id: entity.locality__id})">
                                        <localize en="entity.locality__locality_en" et="entity.locality__locality" />
                                    </a>
                                </td>
                                <td data-ng-if="entity.locality__id === null && entity.locality__locality != null && entity.locality__locality_id != null">
                                    <localize en="entity.locality__locality_en" et="entity.locality__locality" />

                                </td>
                                <td> {{ entity.pages }} </td>
                                <td> {{ entity.figures }} </td>
                                <td> {{ entity.remarks }} </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Specimen link -->
            <div class="col-lg-6" style="margin-top: 2rem" data-ng-if="detailCtrl.specimenReference.length > 0">
                <a href target="_blank" data-ng-click="detailCtrl.service.searchAllSpecimensUsingReference({reference: detailCtrl.results.reference})">
                    {{ 'DETAIL.REFERENCE.SPECIMEN_LINK' | translate }} ({{ detailCtrl.specimenReference.length }})
                </a>
            </div>

            <!-- Taxons -->
            <div class="col-lg-6" data-ng-if="detailCtrl.taxon.length > 0">
                <h3> {{ 'API_TRANSLATION.REFERENCE.TAXON.HEADING' | translate }} </h3>

                <div class="table-responsive">
                    <table class="table table-hover table-bordered">
                        <thead class="styles-for-table-headers">
                        <tr>
                            <th> {{ 'API_TRANSLATION.REFERENCE.TAXON.GENUS' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.TAXON.FAMILY' | translate }} </th>
                            <th> {{ 'API_TRANSLATION.REFERENCE.TAXON.GROUP' | translate }} </th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr data-ng-repeat="entity in detailCtrl.taxon">
                            <td>
                                <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url: 'http://fossiilid.info/' + entity.id})">
                                    <em> {{ entity.taxon }} </em>
                                </a>
                                {{ entity.author_year }}
                            </td>
                            <td>
                                <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url: 'http://fossiilid.info/' + entity.parent_id})">
                                    {{ entity.parent__taxon }}
                                </a>
                            </td>
                            <td>
                                <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url: 'http://fossiilid.info/' + entity.fossil_group__id})">
                                    {{ entity.fossil_group__taxon }}
                                </a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

    </div>

    <div data-ng-if="detailCtrl.results == null && pageHasError" ng-include="'app/templates/main/detailview_error.html'"></div>

</div>

<div ng-include="'app/templates/main/partial/detailview_footer.html'"></div>

<script>
    $(function(){
        $('#elementToFocus').focus();
    });
</script>