<div ng-include="'app/templates/main/partial/detailview_header.html'"></div>

<div class="panel detailview-page">
    <div class="panel-body">

        <div class="row">
            <div class="col-sm-12">
                <div class="detailview-title">
                    <h2>{{'API_TRANSLATION.SAMPLE.DETAIL_FORM_NAME' | translate }} {{detailCtrl.results.number}}</h2>
                    <h4>
                        <em>(ID: {{detailCtrl.results.id}})</em>
                    </h4>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6" bs-loading-overlay bs-loading-overlay-reference-id="detailView" bs-loading-overlay-template-url="app/templates/main/partial/loading.overlay.html">

                <h3> {{ 'DETAILVIEW_TABLE_HEADER' | translate }} </h3>
                <table class="table table-bordered table-hover table-header-styles">
                    <thead>
                    </thead>
                    <tbody>

                    <tr data-ng-if="detailCtrl.results.number && detailCtrl.results.number != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.NUMBER ' | translate }} </td>
                        <td> {{ detailCtrl.results.number }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.number_field && detailCtrl.results.number_field != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.NUMBER_FIELD ' | translate }} </td>
                        <td> {{ detailCtrl.results.number_field }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.number_additional && detailCtrl.results.number_additional != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.NUMBER_ADDITIONAL ' | translate }} </td>
                        <td> {{ detailCtrl.results.number_additional }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.parent_sample && detailCtrl.results.parent_sample != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.PARENT_SAMPLE ' | translate }} </td>
                        <td> {{ detailCtrl.results.parent_sample }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.locality__locality && detailCtrl.results.locality__locality != null)
                        || (detailCtrl.results.locality__locality_en && detailCtrl.results.locality__locality_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.LOCALITY__LOCALITY'"
                                            en="'API_TRANSLATION.SAMPLE.LOCALITY__LOCALITY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'locality',id:detailCtrl.results.locality_id})">
                                <localize et="detailCtrl.results.locality__locality" en="detailCtrl.results.locality__locality_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.locality_free && detailCtrl.results.locality_free != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.LOCALITY_FREE ' | translate }} </td>
                        <td> {{ detailCtrl.results.locality_free }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.soil_site__site && detailCtrl.results.soil_site__site != null)
                        || (detailCtrl.results.soil_site__site_en && detailCtrl.results.soil_site__site_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.SOIL_SITE__SITE'"
                                            en="'API_TRANSLATION.SAMPLE.SOIL_SITE__SITE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.soil_site__site" en="detailCtrl.results.soil_site__site_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.locality__latitude && detailCtrl.results.locality__latitude != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.LOCALITY__LATITUDE ' | translate }} </td>
                        <td> {{ detailCtrl.results.locality__latitude }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.locality__longitude && detailCtrl.results.locality__longitude != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.LOCALITY__LONGITUDE ' | translate }} </td>
                        <td> {{ detailCtrl.results.locality__longitude }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.x1 && detailCtrl.results.x1 != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.X1 ' | translate }} </td>
                        <td> {{ detailCtrl.results.x1 }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.y1 && detailCtrl.results.y1 != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.Y1 ' | translate }} </td>
                        <td> {{ detailCtrl.results.y1 }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.depth && detailCtrl.results.depth != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.DEPTH ' | translate }} </td>
                        <td> {{ detailCtrl.results.depth }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.depth_interval && detailCtrl.results.depth_interval != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.DEPTH_INTERVAL ' | translate }} </td>
                        <td> {{ detailCtrl.results.depth_interval }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.stratigraphy__stratigraphy && detailCtrl.results.stratigraphy__stratigraphy != null)
                        || (detailCtrl.results.stratigraphy__stratigraphy_en && detailCtrl.results.stratigraphy__stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.STRATIGRAPHY__STRATIGRAPHY'"
                                            en="'API_TRANSLATION.SAMPLE.STRATIGRAPHY__STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'stratigraphy',id:detailCtrl.results.stratigraphy_id})">
                                <localize et="detailCtrl.results.stratigraphy__stratigraphy"
                                          en="detailCtrl.results.stratigraphy__stratigraphy_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.lithostratigraphy__stratigraphy && detailCtrl.results.lithostratigraphy__stratigraphy != null) || (detailCtrl.results.lithostratigraphy__stratigraphy_en && detailCtrl.results.lithostratigraphy__stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.LITHOSTRATIGRAPHY__STRATIGRAPHY'"
                                            en="'API_TRANSLATION.SAMPLE.LITHOSTRATIGRAPHY__STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'stratigraphy',id:detailCtrl.results.lithostratigraphy_id})">
                                <localize et="detailCtrl.results.lithostratigraphy__stratigraphy"
                                          en="detailCtrl.results.lithostratigraphy__stratigraphy_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.stratigraphy_free && detailCtrl.results.stratigraphy_free != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.STRATIGRAPHY_FREE ' | translate }} </td>
                        <td> {{ detailCtrl.results.stratigraphy_free }} </td>
                    </tr>


                    <tr data-ng-if="detailCtrl.results.stratigraphy_bed && detailCtrl.results.stratigraphy_bed != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.STRATIGRAPHY_BED ' | translate }} </td>
                        <td> {{ detailCtrl.results.stratigraphy_bed }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.date_collected && detailCtrl.results.date_collected != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.DATE_COLLECTED ' | translate }} </td>
                        <td> {{ detailCtrl.results.date_collected }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.date_collected_free && detailCtrl.results.date_collected_free != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.DATE_COLLECTED_FREE ' | translate }} </td>
                        <td> {{ detailCtrl.results.date_collected_free }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.agent_collected__agent && detailCtrl.results.agent_collected__agent != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.AGENT_COLLECTED__AGENT ' | translate }} </td>
                        <td> {{ detailCtrl.results.agent_collected__agent }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.agent_collected_free && detailCtrl.results.agent_collected_free != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.AGENT_COLLECTED_FREE ' | translate }} </td>
                        <td> {{ detailCtrl.results.agent_collected_free }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.mass && detailCtrl.results.mass != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.MASS ' | translate }} </td>
                        <td> {{ detailCtrl.results.mass }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.sample_purpose__value && detailCtrl.results.sample_purpose__value != null
                        || detailCtrl.results.sample_purpose__value_en && detailCtrl.results.sample_purpose__value_en != null">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.PURPOSE_VALUE'" en="'API_TRANSLATION.SAMPLE.PURPOSE_VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.sample_purpose__value" en="detailCtrl.results.sample_purpose__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.location && detailCtrl.results.location != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.LOCATION ' | translate }} </td>
                        <td> {{ detailCtrl.results.location }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.rock && detailCtrl.results.rock != null)
                        || (detailCtrl.results.rock_en && detailCtrl.results.rock_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.ROCK'" en="'API_TRANSLATION.SAMPLE.ROCK_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.rock" en="detailCtrl.results.rock_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.classification_rock__name && detailCtrl.results.classification_rock__name != null)
                        || (detailCtrl.results.classification_rock__name_en && detailCtrl.results.classification_rock__name_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.SAMPLE.CLASSIFICATION_ROCK__NAME'"
                                            en="'API_TRANSLATION.SAMPLE.CLASSIFICATION_ROCK__NAME_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.classification_rock__name"
                                      en="detailCtrl.results.classification_rock__name_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.soil_horizon && detailCtrl.results.soil_horizon != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.SOIL_HORIZON ' | translate }} </td>
                        <td> {{ detailCtrl.results.soil_horizon }} </td>
                    </tr>


                    <tr data-ng-if="detailCtrl.results.fossils && detailCtrl.results.fossils != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.FOSSILS' | translate }} </td>
                        <td> {{ detailCtrl.results.fossils }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.palaeontology && detailCtrl.results.palaeontology != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.PALAEONTOLOGY' | translate }} </td>
                        <td> {{ detailCtrl.results.palaeontology }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.analysis != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS ' | translate }} </td>
                        <td data-ng-if="detailCtrl.results.analysis">
                            {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_RESULTS_TRUE ' | translate }}
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.remarks && detailCtrl.results.remarks != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.REMARKS ' | translate }} </td>
                        <td> {{ detailCtrl.results.remarks }} </td>
                    </tr>

                    <!--TODO: parent_specimen_id, api 500 error on that field-->

                    <tr data-ng-if="detailCtrl.results.owner__agent && detailCtrl.results.owner__agent != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.OWNER_AGENT ' | translate }} </td>
                        <td> {{ detailCtrl.results.owner__agent }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.date_added && detailCtrl.results.date_added != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.DATE_ADDED ' | translate }} </td>
                        <td> {{ detailCtrl.results.date_added | date:dateFormat }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.date_changed && detailCtrl.results.date_changed != null ">
                        <td> {{ 'API_TRANSLATION.SAMPLE.DATE_CHANGED ' | translate }} </td>
                        <td> {{ detailCtrl.results.date_changed | date:dateFormat }} </td>
                    </tr>

                    </tbody>
                </table>
            </div>

            <div class="col-sm-6">

                <div data-ng-if="detailCtrl.locality.latitude && detailCtrl.locality.longitude">
                    <h3> {{ 'DETAIL.DETAIL_MAP' | translate }} </h3>
                    <div id='hoverbox' class='coupontooltip'>
                        <div id='hoversystem'></div>
                        <div id='hoverstat'></div>
                    </div>
                    <locality-map x = "detailCtrl.locality.latitude" y = "detailCtrl.locality.longitude" name = "detailCtrl.locality.localityEn" fid = "detailCtrl.locality.localityId"></locality-map>
                    <a href data-ng-click="detailCtrl.service.showGoogleMap(detailCtrl.locality.latitude, detailCtrl.locality.longitude, detailCtrl.locality.localityEn)">Google Maps</a></span>
                    &ensp;&ensp;|&ensp;&ensp; <a href data-ng-click="detailCtrl.service.showEstonianLandBoardMap(detailCtrl.locality.latitude, detailCtrl.locality.longitude)">Maa-amet / Estonian Land Board</a>
                </div>

                <div data-ng-if="detailCtrl.taxonList.length > 0">
                    <h3>  {{ 'SEARCH.SAMPLES.TAXON_HEADING' | translate }}  </h3>

                    <table class="table table-bordered table-hover">
                        <thead class="styles-for-table-headers">
                            <tr>
                                <td> {{ 'API_TRANSLATION.SAMPLE.TAXON_NAME' | translate }} </td>
                                <td> {{ 'API_TRANSLATION.SAMPLE.TAXON_NAME' | translate }} </td>
                                <td> {{ 'API_TRANSLATION.SAMPLE.TAXON_FREQUENCY' | translate }} </td>
                                <td> {{ 'API_TRANSLATION.SAMPLE.TAXON_REMARKS' | translate }} </td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="taxon in detailCtrl.taxonList">
                                <td>
                                    <a href data-ng-click="detailCtrl.service.openUrlInNewWindow({url:'http://fossiilid.info/'+taxon.taxon_id})">
                                        {{ taxon.taxon__taxon }}
                                    </a>
                                </td>
                                <td> {{ taxon.name }} </td>
                                <td> {{ taxon.frequency }} </td>
                                <td> {{ taxon.remarks }} </td>
                            </tr>
                        </tbody>
                    </table>

                </div>

                <div data-ng-if="detailCtrl.analysis.length > 0">
                    <h3>  {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_HEADING' | translate }}  </h3>

                    <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                            <thead class="styles-for-table-headers">
                                <tr>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_ID' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_METHOD' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_METHOD_DETAILS' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_MASS' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_DATE' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_LAB' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_AGENT' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_LOCATION' | translate }} </td>
                                    <td> {{ 'API_TRANSLATION.SAMPLE.ANALYSIS_REMARKS' | translate }} </td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="entity in detailCtrl.analysis">
                                    <td>
                                        <a href data-ng-click="detailCtrl.service.openInNewWindow({object:'analysis', id:entity.id})">
                                            {{ entity.id }}
                                        </a>
                                    </td>
                                    <td><localize et="entity.analysis_method__analysis_method" en="entity.analysis_method__analysis_method_en" /></td>
                                    <td><localize et="entity.method_details" en="entity.method_details_en" /></td>
                                    <td> {{ entity.mass }} </td>
                                    <td data-ng-if="entity.date && entity.date != null"> {{ entity.date }} </td>
                                    <td data-ng-if="entity.date == null"> {{ entity.date_free }} </td>
                                    <td> {{ entity.lab_txt }} </td>
                                    <td> {{ entity.agent__agent }} </td>
                                    <td> {{ entity.location }} </td>
                                    <td> {{ entity.remarks }} </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>

            </div>
        </div>


    </div>
</div>

<div ng-include="'app/templates/main/partial/detailview_footer.html'"></div>
