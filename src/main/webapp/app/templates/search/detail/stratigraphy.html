<div ng-include="'app/templates/main/partial/detailview_header.html'"></div>

<div id="elementToFocus" tabindex="1" style="outline: 0" ng-arrow-left="detailCtrl.reload({table:'stratigraphy',left:true})" ng-arrow-right="detailCtrl.reload({table:'stratigraphy', right:true})"  class="panel detailview-page">
    <div class="panel-body detailview-max-width" data-ng-if="detailCtrl.results != null">

        <div class="row">
            <div class="col-sm-12">
                <div class="detailview-title">
                    <h2>
                        <localize et="detailCtrl.results.stratigraphy" en="detailCtrl.results.stratigraphy_en"/>
                    </h2>
                    <div>
                        <em>(ID: {{detailCtrl.results.id}})</em>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6" bs-loading-overlay bs-loading-overlay-reference-id="detailView" bs-loading-overlay-template-url="app/templates/main/partial/loading.overlay.html">


                <h3> {{ 'DETAILVIEW_TABLE_HEADER' | translate }} </h3>
                <table class="table table-bordered table-hover table-header-styles">
                    <thead>
                    </thead>
                    <tbody>

                    <tr data-ng-if="(detailCtrl.results.stratigraphy && detailCtrl.results.stratigraphy != null)
                        || (detailCtrl.results.stratigraphy_en && detailCtrl.results.stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.STRATIGRAPHY'"
                                            en="'API_TRANSLATION.STRATIGRAPHY.STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.stratigraphy" en="detailCtrl.results.stratigraphy_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.parent__stratigraphy && detailCtrl.results.parent__stratigraphy != null)
                        || (detailCtrl.results.parent__stratigraphy_en && detailCtrl.results.parent__stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.PARENT__STRATIGRAPHY'"
                                            en="'API_TRANSLATION.STRATIGRAPHY.PARENT__STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-if="detailCtrl.results.parent_id != null"
                               data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: detailCtrl.results.parent_id})">
                                <localize et="detailCtrl.results.parent__stratigraphy"
                                          en="detailCtrl.results.parent__stratigraphy_en"/>
                            </a>
                        </td>
                    </tr>

                    <!-- TODO: overlain by, this is it -->
                    <tr data-ng-if="detailCtrl.results.overlain_by.count > 0">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.OVERLAIN_BY'" en="'API_TRANSLATION.STRATIGRAPHY.OVERLAIN_BY_EN'" />
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: detailCtrl.results.overlain_by.results[0].id})">
                                <localize et="detailCtrl.results.overlain_by.results[0].stratigraphy" en="detailCtrl.results.overlain_by.results[0].stratigraphy_en" />
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.overlies.count > 0">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.OVERLIES'" en="'API_TRANSLATION.STRATIGRAPHY.OVERLIES_EN'" />
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: detailCtrl.results.overlies.results[0].id})">
                                <localize et="detailCtrl.results.overlies.results[0].stratigraphy" en="detailCtrl.results.overlies.results[0].stratigraphy_en" />
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.type__value && detailCtrl.results.type__value != null)
                        || (detailCtrl.results.type__value_en && detailCtrl.results.type__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.TYPE__VALUE'" en="'API_TRANSLATION.STRATIGRAPHY.TYPE__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.type__value" en="detailCtrl.results.type__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.rank__value && detailCtrl.results.rank__value != null)
                        || (detailCtrl.results.rank__value_en && detailCtrl.results.rank__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.RANK__VALUE'" en="'API_TRANSLATION.STRATIGRAPHY.RANK__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.rank__value" en="detailCtrl.results.rank__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.scope__value && detailCtrl.results.scope__value != null)
                        || (detailCtrl.results.scope__value_en && detailCtrl.results.scope__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.SCOPE__VALUE'" en="'API_TRANSLATION.STRATIGRAPHY.SCOPE__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.scope__value" en="detailCtrl.results.scope__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.region && detailCtrl.results.region != null)
                        || (detailCtrl.results.region_en && detailCtrl.results.region_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.REGION'" en="'API_TRANSLATION.STRATIGRAPHY.REGION_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.region" en="detailCtrl.results.region_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.status__value && detailCtrl.results.status__value != null)
                        || (detailCtrl.results.status__value_en && detailCtrl.results.status__value_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.STATUS__VALUE'"
                                            en="'API_TRANSLATION.STRATIGRAPHY.STATUS__VALUE_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.status__value" en="detailCtrl.results.status__value_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.author_free && detailCtrl.results.author_free != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.AUTHOR_FREE ' | translate }} </td>
                        <td> {{ detailCtrl.results.author_free }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.year && detailCtrl.results.year != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.YEAR ' | translate }} </td>
                        <td> {{ detailCtrl.results.year }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.etymon && detailCtrl.results.etymon != null)
                        || (detailCtrl.results.etymon_en && detailCtrl.results.etymon_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.ETYMON'" en="'API_TRANSLATION.STRATIGRAPHY.ETYMON_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.etymon" en="detailCtrl.results.etymon_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.original_locality && detailCtrl.results.original_locality != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.ORIGINAL_LOCALITY ' | translate }} </td>
                        <td> {{ detailCtrl.results.original_locality }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.age_top && detailCtrl.results.age_top != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.AGE_TOP ' | translate }} </td>
                        <td> {{ detailCtrl.results.age_top }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.age_base && detailCtrl.results.age_base != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.AGE_BASE ' | translate }} </td>
                        <td> {{ detailCtrl.results.age_base }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.age_chronostratigraphy__stratigraphy  && detailCtrl.results.age_chronostratigraphy__stratigraphy != null)
                        || (detailCtrl.results.age_chronostratigraphy__stratigraphy_en && detailCtrl.results.age_chronostratigraphy__stratigraphy_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.AGE_CHRONOSTRATIGRAPHY__STRATIGRAPHY'"
                                            en="'API_TRANSLATION.STRATIGRAPHY.AGE_CHRONOSTRATIGRAPHY__STRATIGRAPHY_EN'"/>
                        </td>
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: detailCtrl.results.age_chronostratigraphy_id})">
                                <localize et="detailCtrl.results.age_chronostratigraphy__stratigraphy"
                                          en="detailCtrl.results.age_chronostratigraphy__stratigraphy_en"/>
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.age_reference__reference && detailCtrl.results.age_reference__reference != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.AGE_REFERENCE__REFERENCE ' | translate }} </td>
                        <td>
                            <a href data-ng-if="detailCtrl.results.age_reference__id != null"
                               data-ng-click="detailCtrl.service.openInNewWindow({object: 'reference', id: detailCtrl.results.age_reference__id})">
                                {{ detailCtrl.results.age_reference__reference }}
                            </a>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.index_main_html && detailCtrl.results.index_main_html != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.INDEX_MAIN_HTML ' | translate }} </td>
                        <td><span ng-bind-html="detailCtrl.results.index_main_html"></span></td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.index_additional_html && detailCtrl.results.index_additional_html != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.INDEX_ADDITIONAL_HTML ' | translate }} </td>
                        <td> <span ng-bind-html="detailCtrl.results.index_additional_html"></span></td>
                    </tr>


                    <tr data-ng-if="(detailCtrl.results.index_main && detailCtrl.results.index_main != null)
                        && detailCtrl.results.index_main_html === null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.INDEX_MAIN ' | translate }} </td>
                        <td> {{ detailCtrl.results.index_main }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.index_additional && detailCtrl.results.index_additional != null)
                        && detailCtrl.results.index_additional_html === null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.INDEX_ADDITIONAL ' | translate }} </td>
                        <td> {{ detailCtrl.results.index_additional }} </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.color_code_cgmw && detailCtrl.results.color_code_cgmw != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.COLOR_CODE_CGMW ' | translate }} </td>
                        <td> {{ detailCtrl.results.color_code_cgmw }} </td>
                    </tr>

                    <!-- TODO: color code usgs, api returns error 500 -->

                    <tr data-ng-if="detailCtrl.results.max_thickness && detailCtrl.results.max_thickness != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.MAX_THICKNESS ' | translate }} </td>
                        <td> {{ detailCtrl.results.max_thickness }} </td>
                    </tr>

                    <tr data-ng-if="(detailCtrl.results.lithology && detailCtrl.results.lithology != null)
                        || (detailCtrl.results.lithology_en && detailCtrl.results.lithology_en != null) ">
                        <td>
                            <localize-label et="'API_TRANSLATION.STRATIGRAPHY.LITHOLOGY'" en="'API_TRANSLATION.STRATIGRAPHY.LITHOLOGY_EN'"/>
                        </td>
                        <td>
                            <localize et="detailCtrl.results.lithology" en="detailCtrl.results.lithology_en"/>
                        </td>
                    </tr>

                    <tr data-ng-if="detailCtrl.results.remarks && detailCtrl.results.remarks != null">
                        <td> {{ 'API_TRANSLATION.STRATIGRAPHY.REMARKS ' | translate }} </td>
                        <td> {{ detailCtrl.results.remarks }} </td>
                    </tr>

                    </tbody>
                </table>

                <div data-ng-if="detailCtrl.results.lithostratigraphies.count > 0">
                    <h3> {{ 'DETAIL.STRATIGRAPHY.LITHOSTRATIGRAPHY_HEADING' | translate }} </h3>

                    <div>
                        <table class="table table-bordered table-hover">
                            <thead class="styles-for-table-headers">
                            <tr>
                                <th> {{ 'DETAIL.STRATIGRAPHY.STRATIGRAPHY' | translate }} </th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr data-ng-repeat="entity in detailCtrl.results.lithostratigraphies.results">
                                <td>
                                    <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'stratigraphy', id: entity.id})">
                                        <localize en="entity.stratigraphy_en" et="entity.stratigraphy" />
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>

            <!-- References -->
            <div class="col-sm-6" data-ng-if="detailCtrl.stratigraphyReference.length > 0">
                <h3> {{ 'DETAIL.DETAIL_REFERENCES' | translate }} </h3>

                <table class="table table-bordered table-hover">
                    <thead class="styles-for-table-headers">
                    <tr>
                        <th> {{ 'API_TRANSLATION.STRATIGRAPHY.REFERENCE' | translate }} </th>
                        <th> {{ 'API_TRANSLATION.STRATIGRAPHY.REFERENCE_PAGES' | translate }} </th>
                        <th> {{ 'API_TRANSLATION.STRATIGRAPHY.REFERENCE_REMARKS' | translate }} </th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr data-ng-repeat="entity in detailCtrl.stratigraphyReference">
                        <td>
                            <a href data-ng-click="detailCtrl.service.openInNewWindow({object: 'reference', id: entity.reference_id})">
                                {{ entity.reference__reference }}
                            </a>
                        </td>
                        <td>{{ entity.pages }}</td>
                        <td>{{ entity.remarks }}</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="col-sm-6">

                <!-- Stratotypes -->
                <div data-ng-if="detailCtrl.stratigraphyStratotype.length > 0">
                    <h3> {{ 'DETAIL.DETAIL_STRATOTYPE' | translate }} </h3>
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                            <thead class="styles-for-table-headers">
                            <tr>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.STRATOTYPE_TYPE' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.STRATOTYPE_LOCALITY' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.STRATOTYPE_DEPTH' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.STRATOTYPE_REFERENCE' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.STRATOTYPE_REMARKS' | translate }} </th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr data-ng-repeat="entity in detailCtrl.stratigraphyStratotype">
                                <td><localize et="entity.stratotype_type__value" en="entity.stratotype_type__value_en"/></td>
                                <td>
                                    <a href data-ng-if="entity.locality__id !== null"
                                       data-ng-click="detailCtrl.service.openInNewWindow({object: 'locality', id: entity.locality__id})">
                                        <localize et="entity.locality__locality" en="entity.locality__locality_en"/>
                                    </a>
                                </td>
                                <td ng-if="entity.depth_top !== null && entity.depth_base !== null">
                                    {{ entity.depth_top + ".." + entity.depth_base }}
                                </td>
                                <td ng-if="entity.depth_top === null && entity.depth_base === null"></td>
                                <td>
                                    <a href data-ng-if="entity.reference__id !== null"
                                       data-ng-click="detailCtrl.service.openInNewWindow({object: 'reference', id: entity.reference__id})">
                                        {{ entity.reference__reference }}
                                    </a>
                                </td>
                                <td> {{ entity.remarks }} </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Synonyms -->
                <div data-ng-if="detailCtrl.stratigraphySynonym.length > 0">
                    <h3> {{ 'DETAIL.DETAIL_STRATIGRAPHY_SYNONYMS' | translate }} </h3>
                    <table class="table table-bordered table-hover">
                        <thead class="styles-for-table-headers">
                            <tr>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.SYNONYM' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.SYNONYM_LANG' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.SYNONYM_REFERENCE' | translate }} </th>
                                <th> {{ 'API_TRANSLATION.STRATIGRAPHY.SYNONYM_REMARKS' | translate }} </th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr data-ng-repeat="entity in detailCtrl.stratigraphySynonym">
                                <td><localize et="entity.synonym" en="entity.synonym_en"/></td>
                                <td><localize et="entity.language__value" en="entity.language__value_en"/></td>
                                <td>
                                    <a href data-ng-if="entity.reference__id !== null"
                                       data-ng-click="detailCtrl.service.openInNewWindow({object: 'reference', id: entity.reference__id})">
                                        {{ entity.reference__reference }}
                                    </a>
                                </td>
                                <td>{{entity.remarks}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- TODO: Add image -->
                <!--<div data-ng-if="detailCtrl.images.length > 0">-->
                    <!--<h3> {{ 'DETAIL.LOCALITY.IMAGES_HEADING'| translate }} </h3>-->

                    <!--<div class="row">-->

                        <!--<div class="col-md-6 col-xs-6" data-ng-repeat="image in detailCtrl.images">-->

                            <!--<figure class="margin-bottom-30">-->

                                <!--<a href="{{detailCtrl.service.composeImageUrl(image)}}" class="hover-me" data-fancybox="gallery"-->
                                   <!--data-caption="{{detailCtrl.service.setFancyBoxCaption(-->
                                       <!--{-->
                                            <!--author: image.author__agent,-->
                                            <!--author_free: image.author_free,-->
                                            <!--date_taken: image.date_taken,-->
                                            <!--date_taken_free: image.date_taken_free,-->
                                            <!--copyright_agent: image.copyright_agent__agent,-->
                                            <!--licence: image.licence__licence_en,-->
                                            <!--licence_url: image.licence__licence_url,-->
                                            <!--licence_url_en: image.licence__licence_url_en,-->
                                            <!--id: image.id-->
                                       <!--})}}">-->

                                    <!--<show-preview class="img-responsive set-height"-->
                                                  <!--classes="previewImageDetail img-rounded"-->
                                                  <!--img-title="[image.author__agent, image.date_taken, image.date_taken_free]"-->
                                                  <!--img-url="detailCtrl.service.composeImageUrl(image)" />-->

                                <!--</a>-->

                            <!--</figure>-->

                        <!--</div>-->

                    <!--</div>-->
                <!--</div>-->

                <!-- Specimen link -->
                <div data-ng-if="detailCtrl.specimens.length > 0">
                    {{ 'DETAIL.STRATIGRAPHY.SPECIMEN_LINK' | translate }}:
                    <a href target="_blank" data-ng-click="detailCtrl.service.searchAllSpecimensUsingStratigraphy({stratigraphy: detailCtrl.results.stratigraphy, stratigraphyEn: detailCtrl.results.stratigraphy_en})">
                        {{detailCtrl.specimens.length}}
                    </a>
                </div>

                <!-- Sample link -->
                <div data-ng-if="detailCtrl.samples.length > 0" style="margin-top: 2rem">
                    {{ 'DETAIL.STRATIGRAPHY.SAMPLE_LINK' | translate }}:
                    <a href target="_blank" data-ng-click="detailCtrl.service.searchAllSamplesUsingStratigraphy({stratigraphy: detailCtrl.results.stratigraphy, stratigraphyEn: detailCtrl.results.stratigraphy_en})">
                        {{detailCtrl.samples.length}}
                    </a>
                </div>


            </div>

            <!-- Description -->
            <div class="col-sm-12" data-ng-if="(detailCtrl.results.description && detailCtrl.results.description != null)
                || (detailCtrl.results.description_en && detailCtrl.results.description_en != null)">
                <h3> {{ 'DETAIL.STRATIGRAPHY.DESCRIPTION_HEADING' | translate }} </h3>
                <div ng-bind-html="detailCtrl.results.description_en"></div>
            </div>

        </div>

    </div>

    <div data-ng-if="detailCtrl.results == null && pageHasError" ng-include="'app/templates/main/detailview_error.html'"></div>

</div>

<div ng-include="'app/templates/main/partial/detailview_footer.html'"></div>

<script>
    $(function(){
        $('#elementToFocus').focus();
    });
</script>